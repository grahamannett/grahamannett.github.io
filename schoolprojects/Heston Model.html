<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1 plus MathML 2.0//EN"
        "HTMLFiles/xhtml-math11-f.dtd">

<!-- Created by Wolfram Mathematica 9.0 for Students - Personal Use Only : www.wolfram.com -->

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
 <title>
  Untitled (Wolfram Mathematica 9.0 for Students - Personal Use Only : www.wolfram.com)
 </title>
 <link href="HTMLFiles/Heston Model.css" rel="stylesheet" type="text/css" />
</head>

<body>

<p class="Title">
 Heston Model<br /><span class="SubtitleInline">Graham Annett<br /></span><span class="SubsubtitleInline">13 December 2013 <br /><br /></span><span class="SectionInline">Introduction<br /></span><span class='TextInline' style='color: #000000;'>In finance, the Heston model, describes the evolution of volatility of an underlying asset. The Heston model is a stochastic volatility model. The model assumes that the volatility of the asset follows a random process, or random walk. <br /><br />The Heston Model has five independent parameters, all of which can be determined by calibrating to the market-observed prices of European options of various strikes or maturity dates. Once a set of parameters has been determined, you can prive other options (parameters are calibrated). Other European options can be priced or American options. The underlying asset price follows a lognormal process, the variance (V) follows a mean-reverting square root process:<br /><br />d</span><span class="TextInline"><span class="TextInline"><span><img src="HTMLFiles/Heston Model_1.gif" alt="Heston Model_1.gif" width="129" height="21" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br /></span><span class="TextInline"><span class="TextInline"><span><img src="HTMLFiles/Heston Model_2.gif" alt="Heston Model_2.gif" width="95" height="18" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'>)dt+&omega;</span><span class="TextInline"><span class="TextInline"><span><img src="HTMLFiles/Heston Model_3.gif" alt="Heston Model_3.gif" width="24" height="20" style="vertical-align:middle" /></span></span></span><span class="TextInline"><span class="TextInline"><span><img src="HTMLFiles/Heston Model_4.gif" alt="Heston Model_4.gif" width="23" height="18" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'>&nbsp;&nbsp;&nbsp;&nbsp;<br /><br />where:<br />r is the risk-free interest rate<br /></span><span class="TextInline"><span class='TextInline' style='color: #000000;'><span><img src="HTMLFiles/Heston Model_5.gif" alt="Heston Model_5.gif" width="26" height="18" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'>and </span><span class="TextInline"><span class='TextInline' style='color: #000000;'><span><img src="HTMLFiles/Heston Model_6.gif" alt="Heston Model_6.gif" width="23" height="18" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'> are two correlated standard Brownian motions <br /><br />5 Parameters are:<br /></span><span class="TextInline"><span class='TextInline' style='color: #000000;'><span><img src="HTMLFiles/Heston Model_7.gif" alt="Heston Model_7.gif" width="17" height="18" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'>=initial variance<br /></span><span class="TextInline"><span class='TextInline' style='color: #000000;'><span><img src="HTMLFiles/Heston Model_8.gif" alt="Heston Model_8.gif" width="19" height="18" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'>= long-run variance<br />&kappa; = speed of mean reversion<br />&omega; = volatility of volatility <br />&rho; = correlation <br /><br />In General, the price at time (t) of a European call options maturity date at time (T) is given by the discounted expected value:<br /><br /></span><span class="TextInline"><span class='TextInline' style='color: #000000;'><span><img src="HTMLFiles/Heston Model_9.gif" alt="Heston Model_9.gif" width="214" height="35" style="vertical-align:middle" /></span></span></span><span class='TextInline' style='color: #000000;'><br />Where </span><span class="TextInline"><span class='TextInline' style='color: #000000;'><span>Log[s]=x </span></span></span><span class='TextInline' style='color: #000000;'><br />And P(x) is the probability density function of the underlying logarithmic asset price. </span>
</p>



<p class="Title">
 <span class="SectionInline">Code</span><span class='SectionInline' style='color: #000000;'><br /></span><span class='TextInline' style='color: #000000;'>For this, we use the mathematica function Ito Process to allow for the &ldquo;randomness&rdquo; that the Wiener process is.&nbsp;&nbsp;This part is the &ldquo;cW&rdquo; equation we use.&nbsp;&nbsp;The 2 differential equation&rsquo;s are &ldquo;solved&rdquo; in the hestonmodel variable and then the output is generated by running </span>
</p>



<p class="Code">
 <img src="HTMLFiles/Heston Model_10.gif" alt="Heston Model_10.gif" width="557" height="158" style="vertical-align:middle" />
</p>

<p class="Text">
 From here, we will plot what the random process looks like:
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_11.gif" alt="Heston Model_11.gif" width="288" height="13" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_12.gif" alt="Heston Model_12.gif" width="360" height="226" style="vertical-align:middle" />
</p>

<p class="Text">
 This plot is a Wiener Process that we then project onto the data for a something such as an asset.&nbsp;&nbsp;We do this by showing how the volatility fluctuates due to the change in price (here we act as if the x axis were are the price of the asset, it is not a time series) and the volatility is then taken from the y axis.&nbsp;&nbsp;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;From here we can plot it as if it were a time series by not including the price since the heston model is more interested in understanding the underlying volatility of some asset.&nbsp;&nbsp;&nbsp;You can follow the intial random process here see how it follows the previous plot but this plot is &ldquo;time series&rdquo; in nature.&nbsp;&nbsp;
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_13.gif" alt="Heston Model_13.gif" width="505" height="13" style="vertical-align:middle" />
</p>

<p class="Input">
 <img src="HTMLFiles/Heston Model_14.gif" alt="Graphics:volatility" width="360" height="238" style="vertical-align:middle" />
</p>

<p class="Text">
 Since we are not limited to plotting to 1 asset, or even one possible outcome of an asset below we will plot 5 and show how they vary amongst themselves.<br />&nbsp;&nbsp;
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_15.gif" alt="Heston Model_15.gif" width="642" height="82" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_16.gif" alt="Graphics:volatility" width="360" height="238" style="vertical-align:middle" />
</p>

<p class="Text">
 From here we can start to further understand the parameters, for instance, as &theta; tends to 0, the volatility tends 0 as well.&nbsp;&nbsp;This intuitevly makes sense as the long run variance is 0, then an assets price would become more stable as future expected price would be within a much smaller predicted range.&nbsp;&nbsp;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_17.gif" alt="Heston Model_17.gif" width="642" height="82" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_18.gif" alt="Graphics:volatility" width="360" height="238" style="vertical-align:middle" />
</p>

<p class="Input">
 <img src="HTMLFiles/Heston Model_19.gif" alt="Heston Model_19.gif" width="568" height="13" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_20.gif" alt="Graphics:Price of the asset" width="360" height="237" style="vertical-align:middle" />
</p>

<p class="Text">
 This follows for any number, as &theta; tends to some &alpha; in the long run the volatility will reach this level and the only volatility will be due to the random process, not long run expectations of an assets variance.&nbsp;&nbsp;Example, if the long run volatility was 10.<br /><br />
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_21.gif" alt="Heston Model_21.gif" width="650" height="82" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_22.gif" alt="Graphics:volatility" width="360" height="240" style="vertical-align:middle" />
</p>

<p class="Text">
 <br />Another interesting aspect to note is how &xi;, the volatility of the volatility, controls the amount of &quot;randomness&quot; that the volatility will have.&nbsp;&nbsp;For instance when &xi; tends to 0, the volatility&nbsp;&nbsp;will become &quot;stable&quot; at the level of lon term volatility.&nbsp;&nbsp;This makes sense from the eqatuations as the process evolves the WeinerProcess will dhave less and less of an effect.
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_23.gif" alt="Heston Model_23.gif" width="637" height="99" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_24.gif" alt="Graphics:volatility" width="360" height="236" style="vertical-align:middle" />
</p>

<p class="Text">
 This model has other extensions as well though, for instance the Chen Model is very similar and is used to model the evolution of interest rates.&nbsp;&nbsp;&nbsp;Using the same initial equation for <span class="doublestruck">d</span>r[t], we extend it to 3 different differential equations.
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_25.gif" alt="Heston Model_25.gif" width="315" height="48" style="vertical-align:middle" />
</p>

<p class="Input">
 <img src="HTMLFiles/Heston Model_26.gif" alt="Heston Model_26.gif" width="717" height="82" style="vertical-align:middle" />
</p>

<p class="Text">
 <br />Which we can then use to show the volatility of the interest rates rather than a super generalized asset.
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_27.gif" alt="Heston Model_27.gif" width="874" height="13" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_28.gif" alt="Heston Model_28.gif" width="360" height="226" style="vertical-align:middle" />
</p>

<p class="Input">
 <img src="HTMLFiles/Heston Model_29.gif" alt="Heston Model_29.gif" width="1291" height="31" style="vertical-align:middle" />
</p>

<p class="Output">
 <img src="HTMLFiles/Heston Model_30.gif" alt="Heston Model_30.gif" width="300" height="191" style="vertical-align:middle" />
</p>

<p class="Title">
 <span class='SectionInline' style='color: #000000;'><br /></span><span class="SectionInline">References<br /></span><span class='TextInline' style='color: #000000;'>Heston, S. (1993) 'A closed-form solution for options with stochastic volatility', Review of Financial Studies,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6, 327-43.<br /><br />&quot;The Heston Model of Stochastic Volatility: Fast Option Pricing and Accurate Calibration.&quot; FinCad. Web. 13&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;December 2013. &lt;http://www.fincad.com/derivatives-resources/articles/heston-model-stochastic-&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;volatility.aspx#ref3&gt;. <br /><br />Followed Examples on </span><span class='TextInline' style='font-style: italic;color: #000000;'>Mathematica</span><span class='TextInline' style='color: #000000;'> Tutorials as well to understand how these models are implemented and what is happening.<br /></span>
</p>



<p class="Input">
 <img src="HTMLFiles/Heston Model_31.gif" alt="Heston Model_31.gif" width="4" height="13" style="vertical-align:middle" />
</p>




<div style="font-family:Helvetica; font-size:11px; width:100%; border:1px none #999999; border-top-style:solid; padding-top:2px; margin-top:20px;">
 <a href="http://www.wolfram.com/products/mathematica/" style="color:#000; text-decoration:none;">
  <img src="HTMLFiles/spikeyIcon.png" alt="Spikey" width="20" height="21" style="padding-right:2px; border:0px solid white; vertical-align:middle;" />
  <span style="color:#555555">Created with</span> Wolfram <span style="font-style: italic;">Mathematica</span> 9.0
 </a>
</div>
</body>

</html>
